@import 'Common/Color.less';
@import '../../Ibiza/Text.less';

@color-toolbar: #eee;
@color-toolbar-dark: rgba(128, 128, 128, 0.25);

@color-toolbar-dropdown-dark: rgb(45, 45, 45);
@color-chart-icon-darker-disabled: @color-text-disabled;
@color-chart-icon-lighter-disabled: #ddd;
@color-chart-icon-darker-dark: @primary-selected-dark-button;
@color-chart-icon-lighter-dark: @primary-hover-dark-button;
@color-chart-icon-darker-disabled-dark: @color-text-disabled;
@color-chart-icon-lighter-disabled-dark: #666;

// **** NOTE: Please make sure to update styles for high contrast as well as dark theme **** //

.chart-toolbar {
  background-color: @color-toolbar;
  display: flex;
  flex-direction: row;
  justify-content: space-between;
  margin: 10px 0;
  position: relative;

  > div {
    display: flex;
    align-items: center;
  }

  .add-filter {
    &.disabled {
      svg {
        path,
        polygon,
        circle {
          fill: none;
          stroke: @color-text-disabled;
        }
  
        rect {
          fill: @color-text-disabled;
        }
      }
    }

    svg {
      path,
      polygon,
      circle {
        fill: none;
        stroke: @command-bar-light;
      }

      rect {
        fill: @command-bar-light;
      }
    }
  }

  .button-dropdown {
    padding: 0;
    height: 100%;
  }

  .button-chart-type {
    .icon svg {
      .command-icon(light);
    }

    .icon-open {
      padding-left: 5px;
    }

    .dropdown-content {
      right: 280px;

      .dropdown-logo.isDisabled svg {
        .command-icon(light, disabled);
      }
    }
  }

  .icon-open {
    display: flex;
    align-items: center;
    justify-content: center;

    svg {
      height: 16px;
      width: 16px;

      circle,
      polygon,
      path {
        fill: #000;
      }

      line {
        stroke: #000;
      }
    }
  }

  /* The container <div> - needed to position the dropdown content */
  .dropdown {
    position: relative;
    display: inline-block;
  }

  /* Dropdown Content (Hidden by Default) */
  .dropdown-content {
    display: none;
    position: absolute;
    border: 1px solid @color-border;
    background-color: white;
    min-width: 200px;
    overflow: auto;
    box-shadow: 0 8px 16px 0 rgba(0, 0, 0, 0.2);
    top: 35px;
    right: 0;
    z-index: 100;

    &.shown {
      display: block;
    }

    .dropdown-items {
      display: flex;
      flex-direction: row;
      align-items: center;
      justify-content: left;
      color: black;
      padding: 7px 15px 7px 10px;
      text-decoration: none;
      font-size: 14px;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;

      &:hover:not(.disabled) {
        background-color: @primary-hover-light;
      }

      &.active {
        background-color: @primary-selected-light;
      }

      &.disabled {
        cursor: default;
        color: @color-text-disabled;
        
        .dropdown-logo svg path {
          fill: @color-text-disabled;
        }
      }

      .dropdown-logo {
        display: flex;
        align-items: center;
        justify-content: center;

        svg {
          height: 16px;
          width: 16px;

          .command-icon(light);
        }
      }

      .dropdown-label {
        padding-left: 10px;
      }
    }

    /* Links inside the dropdown */
    a {
      color: black;
      padding: 12px 16px 20px 40px;
      text-decoration: none;
      display: block;

      &:hover {
        background-color: @primary-hover-light;
      }

      &.active {
        background-color: @primary-selected-light;
      }
    }
  }
}

.chart-menu {
  display: flex;
  padding: 5px 8px;
}

/* Show the dropdown menu (use JS to add this class to the .dropdown-content container when the user clicks on the dropdown button) */
.show {
  display: block;
}

.dark,
.fxs-theme-dark {
  .chart-toolbar {
    background-color: @color-toolbar-dark;
  }

  .disabled > .icon {
    svg {
      path,
      polygon,
      circle,
      rect {
        fill: @color-text-disabled;
      }

      line {
        stroke: @color-text-disabled;
      }
    }
  }

  .add-filter svg {
    path,
    polygon,
    circle {
      stroke: @color-chart-icon-darker-dark;
    }
  }

  .button-chart-type {
    .icon svg {
      .command-icon(dark);
    }

    .dropdown-content .dropdown-items .dropdown-logo.isDisabled svg {
      .command-icon(dark, disabled);
    }
  }

  .icon-open {
    svg {
      circle,
      polygon,
      path {
        fill: #fff;
      }

      line {
        stroke: #fff;
      }
    }
  }

  .chart-toolbar .dropdown-content {
    border: 1px solid #7f8080;
    background-color: @color-toolbar-dropdown-dark;

    .dropdown-items {
      color: #fff;

      &:hover:not(.disabled) {
        background-color: @primary-hover-dark;
      }

      &.active {
        background-color: @primary-selected-dark;
      }

      &:not(.disabled) .dropdown-logo svg {
        .command-icon(@color-chart-icon-darker-dark, @color-chart-icon-lighter-dark);
      }

      .dropdown-logo svg {
        .command-icon(dark);
      }
    }
  }
}

@media screen and (-ms-high-contrast: black-on-white) {
  .light.high-contrast;
  .hc-ie(@highcontrast-light-fg);
}

@media screen and (-ms-high-contrast: white-on-black) {
  .dark.high-contrast;
  .hc-ie(@highcontrast-dark-fg);
}

.light.high-contrast {
  .hc(@highcontrast-light-bg, @highcontrast-light-fg, @highcontrast-light-bgSelect, @highcontrast-light-fgSelect, @highcontrast-light-disabled);
}

.dark.high-contrast {
  .hc(@highcontrast-dark-bg, @highcontrast-dark-fg, @highcontrast-dark-bgSelect, @highcontrast-dark-fgSelect, @highcontrast-dark-disabled);
}

.hc(@bg, @fg, @bgSelect, @fgSelect, @disabled) {
  .chart-toolbar {
    background: @bg;
    color: @fg;
    border: 1px solid @fg;

    .button-dropdown {
      &:hover {
        .icon-open {
          .command-icon(@fgSelect, @fgSelect);
        }
      }
    }
  
    .dropdown-content {
      border: 1px solid @fg;
      background-color: @bg;
  
      .dropdown-items {
        color: @fg;
  
        .dropdown-logo svg {
          .command-icon(@fg, @fg);
        }
  
        &.disabled {
          color: @disabled;
  
          .dropdown-logo svg {
            .command-icon(@disabled, @disabled);
          }
        }
  
        &:hover:not(.disabled),
        &.active {
          background-color: @bgSelect;
          color: @fgSelect;
  
          .dropdown-logo svg {
            .command-icon(@fgSelect, @fgSelect);
          }
        }
      }
    }
  }
}

// Edge/IE will add an additional background to the text/icon itself
.hc-ie(@fg) {
  .chart-toolbar .dropdown-content .dropdown-items {
    &:hover:not(.disabled),
    &.active {
      color: @fg;

      .dropdown-logo svg {
        .command-icon(@fg, @fg);
      }
    }
  }
}

/** Mixins */
.command-icon(@darker-fill, @lighter-fill) {
  rect,
  polyline,
  polygon,
  circle,
  path {
    fill: @darker-fill;
  }

  .lighter {
    fill: @lighter-fill;
  }
}

.command-icon(light) {
  .command-icon(@command-bar-light, #59b4d9);
}

.command-icon(light, disabled) {
  .command-icon(@color-chart-icon-darker-disabled, @color-chart-icon-lighter-disabled);
}

.command-icon(dark) {
  .command-icon(@color-chart-icon-darker-dark, @color-chart-icon-lighter-dark);
}

.command-icon(dark, disabled) {
  .command-icon(@color-chart-icon-darker-disabled-dark, @color-chart-icon-lighter-disabled-dark);
}
