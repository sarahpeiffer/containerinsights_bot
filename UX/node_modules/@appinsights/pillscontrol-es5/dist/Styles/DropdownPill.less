@import "Variables";
@import "Mixins";

@defaultDropdownWidth: 200px;

.aim-pill {
  .aim-select-links {
    padding: 5px 10px;
    width: 100%;
    cursor: pointer;

    input[type=checkbox] {
      margin-left: 0;
    }

    span {
      padding-left: 6px;
    }
  }

  .configured {
    max-width: 160px;
    display: flex;

    div {
      /* Each component is capped off at 75% of max width
       * This allows each of them to appear on the pill without dominating space
       */
      max-width: 120px;
      min-width: 20px;
      flex: 1 1 auto;
      .ellipsify(true);
    }

    .operator {
      min-width: 10px;
      max-width: 40px;
      flex: 0 0 auto;
      padding: 0 2px;
    }

    .values {
      font-family: @pill-font-family-bold;
      font-weight: bold;
    }
  }

  .aim-pill-pickers {
    display: flex;
    align-items: center;
    font-family: @pill-font-family;
    font-size: @pill-font-size;
    flex-wrap: wrap;

    .aim-pill-dropdown-with-labels {
      margin: 0 2.5px;

      label {
        font-family: @pill-font-family-semibold;
        font-size: 13px;
        line-height: 18px;
        color: @pill-text-light;
        padding: 0 2px 2px;
        height: 8px;
      }

      .operator-fixed {
        text-align: center;
      }
    }

    /* Style the dropdown controls */
    .Select-control {
      height: 23px;
      width: 170px;
      border-radius: 0;
      border: 1px solid @pill-dropdown-border-light;
      display: flex;

      &:hover {
        border-color: @pill-selected-light;
      }

      .Select-multi-value-wrapper,
      .Select-value,
      .Select-input,
      .Select-placeholder {
        flex: 1 1 auto;
        height: 18px;
        line-height: 22px;
        color: @pill-text-light;
        padding: 0 20px 3px 8px;
      }

      .Select-value {
        padding-right: 25px;
      }

      .Select-placeholder {
        font-style: italic;
        line-height: 20px;
      }

      .Select-input {
        .ellipsify(true);

        position: relative;
        top: -2px;
        left: -8px;
        margin-left: 0;
      }

      .icon-dropdown-search {
        position: relative;
        top: 2px;
        width: 20px;
        height: 14px;
      }

      .Select-arrow-zone {
        width: 16px;
        display: flex;
        align-items: center;
        justify-content: center;

        path {
          fill: @pill-text-light;
        }
      }
    }

    .Select {
      &.is-focused:not(.is-open) {
        .Select-control {
          border-color: @pill-selected-light;
        }
      }
    }

    /* Style the dropdown options */
    .Select-option {
      .ellipsify(true);
      .no-border-bottom-radius();

      max-width: 100%;
      padding: 1px 4px 4px 8px;
      color: @pill-text-light;
      z-index: 1000;

      &.is-selected {
        background-color: @pill-dropdown-selected-light;
      }

      &.is-focused {
        background-color: @pill-dropdown-hover-light;
      }

      .additional-qualifier-left {
        margin-left: 20px;
        color: @pill-dropdown-border-light;
      }

      .value-with-check {
        display: flex;
        align-items: center;

        .value {
          padding-left: 6px;
          .ellipsify(true);
        }
      }
    }

    /* Force dropdown menu to appear left-most */
    .Select-menu-outer {
      .no-border-bottom-radius();

      width: @defaultDropdownWidth;
      left: 0;
      border-color: @pill-dropdown-menu-border-light;
      z-index: 1000;
      top: 105%;
    }

    .aim-virtualized-menu {
      outline: 1px solid @pill-dropdown-menu-border-light;
    }
    
    .aim-pill-dropdown {
      &.virtualized {
        > .Select-menu-outer {
          width: unset;
          min-width: @defaultDropdownWidth;
          overflow-y: visible;
        }
      }
    }

    .aim-metric-namespace {
      .Select-menu-outer {
        width: 265px;
        max-width: 265px;
      }
    }

    .aim-metric-metric,
    .aim-metric-metric.virtualized {
      .Select-menu-outer {
        width: 300px;
        max-width: 72vw;
      }
    }

    .aim-filter-operator {
      .Select-control {
        width: 50px;

        .Select-multi-value-wrapper {
          width: 30px;
        }
      }
    }
  }
}

.dark .aim-pillcontainer .aim-pill {
  .aim-pill-pickers {
    .aim-pill-dropdown-with-labels {
      label {
        color: @pill-text-dark;
      }
    }

    .Select.has-value.Select--single > .Select-control .Select-value .Select-value-label {
      color: @pill-text-dark;
    }

    .Select-control {
      background-color: @pill-bg-dark;
      border-color: @pill-dropdown-border-dark;

      &:hover {
        border-color: @pill-selected-dark;
      }

      .Select-input input,
      .Select-placeholder,
      .Select-value .Select-value-label {
        color: @pill-text-dark;
      }

      .Select-arrow-zone {
        path {
          fill: @pill-text-dark;
        }
      }
    }

    .Select {
      &.is-focused:not(.is-open) {
        .Select-control {
          border-color: @pill-selected-dark;
        }
      }
    }

    .Select-option {
      .no-border-bottom-radius();

      background-color: @pill-bg-dark;
      color: @pill-text-dark;

      &.is-selected {
        background-color: @pill-dropdown-selected-dark;
      }

      &.is-focused {
        background-color: @pill-dropdown-hover-dark;
      }
    }

    .Select-menu-outer {
      background-color: @pill-bg-dark;
      border-color: @pill-dropdown-menu-border-dark;
    }
  }
}

@media screen and (-ms-high-contrast: black-on-white) {
  .light.high-contrast;
  .hc-ie(@highcontrast-light-fg);
}

@media screen and (-ms-high-contrast: white-on-black) {
  .dark.high-contrast;
  .hc-ie(@highcontrast-dark-fg);
}

.light.high-contrast {
  .hc(@highcontrast-light-fg, @highcontrast-light-bgSelect, @highcontrast-light-fgSelect);
}

.dark.high-contrast {
  .hc(@highcontrast-dark-fg, @highcontrast-dark-bgSelect, @highcontrast-dark-fgSelect);
}

.hc(@fg, @bgSelect, @fgSelect) {
  .aim-pill .aim-pill-pickers {
    .Select.is-open > .Select-control {
      border-color: @bgSelect;

      .Select-value-label {
        color: @bgSelect;
      }
    }

    .Select-control {
      border-color: @fg;

      &:hover,
      &:focus {
        border-color: @bgSelect;

        .Select-placeholder {
          color: @bgSelect;
        }
      }
    }

    .Select-option {
      &.is-selected,
      &.is-focused {
        background-color: @bgSelect;
        color: @fgSelect;
  
        .value {
          padding-right: 6px;
        }
      }
    }

    .Select {
      &.is-focused:not(.is-open) {
        .Select-control {
          border-color: @bgSelect;
        }
      }
    }
  }
}

/* IE/Edge add a black background to most text/icon elements */
.hc-ie(@fg) {
  .aim-pill .aim-pill-pickers .Select-option {
    &.is-selected,
    &.is-focused {
      color: @fg;
    }
  }
}
