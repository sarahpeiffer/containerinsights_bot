import { DropdownMessageOption } from './DropdownMessageOption';
import { MenuItem } from './MenuItem';
import * as KeyCodes from '../../KeyCodes';
describe('DropdownMessageOption', function () {
    var props;
    var subProps;
    var PostMessage;
    var option;
    beforeEach(function () {
        props = {
            name: 'my option',
            message: 'message',
            data: {},
            onClick: function () { },
            messageService: { PostMessage: function () { } },
            offset: true,
            focusIndex: -1,
            group: 'my group',
            icon: {},
            index: 1,
            onHover: function () { },
            onHoverEnd: function () { }
        };
        subProps = (_a = {
                className: 'dropdown-option',
                onClick: function () { },
                onMouseEnter: function () { },
                onMouseLeave: function () { },
                ref: function () { },
                tabIndex: -1
            },
            _a['aria-label'] = 'label',
            _a);
        spyOn(props, 'onClick');
        spyOn(subProps, 'ref');
        PostMessage = spyOn(props.messageService, 'PostMessage');
        option = new DropdownMessageOption(props);
        var _a;
    });
    it('should have a menu item', function () {
        var rendered = option.render();
        expect(rendered.type).toBe(MenuItem);
        expect(rendered.props.name).toBe(props.name);
        expect(rendered.props.onClick).toBe(props.onClick);
        expect(rendered.props.onHover).toBe(props.onHover);
        expect(rendered.props.onHoverEnd).toBe(props.onHoverEnd);
        expect(rendered.props.focusIndex).toBe(props.focusIndex);
        expect(rendered.props.index).toBe(props.index);
        expect(rendered.props.group).toBe(props.group);
    });
    it('should have a list item', function () {
        var rendered = option.render();
        var item = rendered.props.content(subProps);
        expect(item.type).toBe('li');
        expect(item.props.className).toBe('dropdown-option dropdown-link dropdown-message');
        expect(item.props.onMouseEnter).toBe(subProps.onMouseEnter);
        expect(item.props.onMouseLeave).toBe(subProps.onMouseLeave);
        item.ref();
        expect(subProps.ref).toHaveBeenCalled();
        expect(item.props.tabIndex).toBe(subProps.tabIndex);
        expect(item.props['aria-label']).toBe(subProps['aria-label']);
        expect(item.props.role).toBe('menuitem');
        var e = {
            stopPropagation: function () { }
        };
        spyOn(e, 'stopPropagation');
        item.props.onClick(e);
        expect(e.stopPropagation).toHaveBeenCalledTimes(1);
        expect(PostMessage).toHaveBeenCalledTimes(1);
        expect(PostMessage).toHaveBeenCalledWith(props.message, props.data);
        expect(props.onClick).toHaveBeenCalledTimes(1);
        var image = item.props.children[0];
        expect(image).toBe(props.icon);
        var title = item.props.children[1];
        expect(title.props.className).toBe('dropdown-offset');
        expect(title.props.children).toBe(props.name);
    });
    it('should trigger click if enter pressed', function () {
        var rendered = option.render();
        var item = rendered.props.content(subProps);
        expect(item.type).toBe('li');
        var e = {
            stopPropagation: function () { },
            preventDefault: function () { },
            keyCode: KeyCodes.ENTER
        };
        spyOn(e, 'stopPropagation');
        spyOn(e, 'preventDefault');
        item.props.onKeyDown(e);
        expect(props.onClick).toHaveBeenCalled();
        expect(PostMessage).toHaveBeenCalled();
        expect(e.stopPropagation).toHaveBeenCalled();
        expect(e.preventDefault).toHaveBeenCalled();
    });
    it('should trigger click if space pressed', function () {
        var rendered = option.render();
        var item = rendered.props.content(subProps);
        expect(item.type).toBe('li');
        var e = {
            stopPropagation: function () { },
            preventDefault: function () { },
            keyCode: KeyCodes.SPACEBAR
        };
        spyOn(e, 'stopPropagation');
        spyOn(e, 'preventDefault');
        item.props.onKeyDown(e);
        expect(props.onClick).toHaveBeenCalled();
        expect(PostMessage).toHaveBeenCalled();
        expect(e.stopPropagation).toHaveBeenCalled();
        expect(e.preventDefault).toHaveBeenCalled();
    });
    it('should not trigger click if other key pressed', function () {
        var rendered = option.render();
        var item = rendered.props.content(subProps);
        expect(item.type).toBe('li');
        var e = {
            stopPropagation: function () { },
            preventDefault: function () { },
            keyCode: KeyCodes.END
        };
        spyOn(e, 'stopPropagation');
        spyOn(e, 'preventDefault');
        item.props.onKeyDown(e);
        expect(props.onClick).not.toHaveBeenCalled();
        expect(PostMessage).not.toHaveBeenCalled();
        expect(e.stopPropagation).not.toHaveBeenCalled();
        expect(e.preventDefault).not.toHaveBeenCalled();
    });
    it('should not have offset if offset false', function () {
        props.offset = false;
        var rendered = option.render();
        var item = rendered.props.content(subProps);
        var title = item.props.children[1];
        expect(title.props.className).toBe('');
    });
});
//# sourceMappingURL=DropdownMessageOption.spec.js.map